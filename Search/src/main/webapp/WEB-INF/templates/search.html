<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

    <head th:fragment="header">
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../../resources/css/style.css" th:href="@{/resources/css/style.css}" />
        <link rel="stylesheet" href="resources/lib/css/reset.css" type="text/css" media="screen" charset="utf-8"/>
        <link rel="stylesheet" href="resources/lib/css/icons.css" type="text/css" media="screen" charset="utf-8"/>
        <link rel="stylesheet" href="resources/lib/css/workspace.css" type="text/css" media="screen" charset="utf-8"/>

        <script src="resources/js/vendor/jquery-1.11.0.js" type="text/javascript" charset="utf-8"></script>
        <!-- <script src="vendor/backported/jquery-1.4.4.js" type="text/javascript" charset="utf-8"></script> -->
        <script src="resources/js/vendor/jquery.ui.core.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/js/vendor/jquery.ui.widget.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/js/vendor/jquery.ui.position.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/js/vendor/jquery.ui.menu.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/js/vendor/jquery.ui.autocomplete.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/js/vendor/underscore-1.5.2.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/js/vendor/backbone-1.1.0.js" type="text/javascript" charset="utf-8"></script>

        <script src="resources/lib/js/visualsearch.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/views/search_box.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/views/search_facet.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/views/search_input.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/models/search_facets.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/models/search_query.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/utils/backbone_extensions.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/utils/hotkeys.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/utils/jquery_extensions.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/utils/search_parser.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/utils/inflector.js" type="text/javascript" charset="utf-8"></script>
        <script src="resources/lib/js/templates/templates.js" type="text/javascript" charset="utf-8"></script>
        <title>Title</title>
    </head>

    <body>
        <div class="skin">
            <div class="content">
                <div th:include="include :: menu"></div>
                <div th:include="include :: logo"></div>

                <div class="postbox">
                    <div id="search_box_container"></div>
                    <div id="search_query">&nbsp;</div>

                    <script type="text/javascript" charset="utf-8">
                        
                        // recupera la informacion de los registros de la consulta
                        function recuperarConsulta_callback(ajaxResponse, textStatus)
                        {
                            var registros = procesarRespuesta(ajaxResponse);
                            if (!registros)
                            {
                                // no se encontraron registros :(
                                return;
                            }
  
                        }
                        $(document).ready(function() {
                            window.visualSearch = VS.init({
                                container  : $('#search_box_container'),
                                query      : '',
                                showFacets : true,
                                readOnly   : false,
                                unquotable : [
                                    'text',
                                    'account',
                                    'filter',
                                    'access'
                                ],
                                callbacks  : {
                                    search : function(query, searchCollection) {
                                        var $query = $('#search_query');
                                        $query.stop().animate({opacity : 1}, {duration: 300, queue: false});
                                        $query.html('<span class="raquo">&raquo;</span> You searched for: <b>' + searchCollection.serialize() + '</b>');
                                        clearTimeout(window.queryHideDelay);
                                        var data = "q=" + query;
                                        $.ajax(
                                        {
                                            // puede ser "get" y "post"
                                            type: "get",
                                            // el módulo que hará la búsqueda
                                            url: "/busqueda/consultar",
                                            // los datos para la consulta
                                            data: data,
                                            // que hacer si funciona 
                                            success: recuperarConsulta_callback
                                        });
                                        window.queryHideDelay = setTimeout(function() {
                                            $query.animate({
                                                opacity : 0
                                            }, {
                                                duration: 1000,
                                                queue: false
                                            });
                                        }, 2000);
                                    },
                                    valueMatches : function(category, searchTerm, callback) {
                                        switch (category) {
                                            case 'account':
                                                callback([
                                                    { value: '1-amanda', label: 'Amanda' },
                                                    { value: '2-aron',   label: 'Aron' },
                                                    { value: '3-eric',   label: 'Eric' },
                                                    { value: '4-jeremy', label: 'Jeremy' },
                                                    { value: '5-samuel', label: 'Samuel' },
                                                    { value: '6-scott',  label: 'Scott' }
                                                ]);
                                                break;
                                            case 'filter':
                                                callback(['published', 'unpublished', 'draft']);
                                                break;
                                            case 'access':
                                                callback(['public', 'private', 'protected']);
                                                break;
                                            case 'title':
                                                callback([
                                                    'Pentagon Papers',
                                                    'CoffeeScript Manual',
                                                    'Laboratory for Object Oriented Thinking',
                                                    'A Repository Grows in Brooklyn'
                                                ]);
                                                break;
                                            case 'city':
                                                callback([
                                                    'Cleveland',
                                                    'New York City',
                                                    'Brooklyn',
                                                    'Manhattan',
                                                    'Queens',
                                                    'The Bronx',
                                                    'Staten Island',
                                                    'San Francisco',
                                                    'Los Angeles',
                                                    'Seattle',
                                                    'London',
                                                    'Portland',
                                                    'Chicago',
                                                    'Boston'
                                                ])
                                                break;
                                            case 'U.S. State':
                                                callback([
                                                    "Alabama", "Alaska", "Arizona", "Arkansas", "California",
                                                    "Colorado", "Connecticut", "Delaware", "District of Columbia", "Florida",
                                                    "Georgia", "Guam", "Hawaii", "Idaho", "Illinois",
                                                    "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana",
                                                    "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota",
                                                    "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada",
                                                    "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina",
                                                    "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania",
                                                    "Puerto Rico", "Rhode Island", "South Carolina", "South Dakota", "Tennessee",
                                                    "Texas", "Utah", "Vermont", "Virginia", "Virgin Islands",
                                                    "Washington", "West Virginia", "Wisconsin", "Wyoming"
                                                ]);
                                                break
                                            case 'country':
                                                callback([
                                                    "China", "India", "United States", "Indonesia", "Brazil",
                                                    "Pakistan", "Bangladesh", "Nigeria", "Russia", "Japan",
                                                    "Mexico", "Philippines", "Vietnam", "Ethiopia", "Egypt",
                                                    "Germany", "Turkey", "Iran", "Thailand", "D. R. of Congo",
                                                    "France", "United Kingdom", "Italy", "Myanmar", "South Africa",
                                                    "South Korea", "Colombia", "Ukraine", "Spain", "Tanzania",
                                                    "Sudan", "Kenya", "Argentina", "Poland", "Algeria",
                                                    "Canada", "Uganda", "Morocco", "Iraq", "Nepal",
                                                    "Peru", "Afghanistan", "Venezuela", "Malaysia", "Uzbekistan",
                                                    "Saudi Arabia", "Ghana", "Yemen", "North Korea", "Mozambique",
                                                    "Taiwan", "Syria", "Ivory Coast", "Australia", "Romania",
                                                    "Sri Lanka", "Madagascar", "Cameroon", "Angola", "Chile",
                                                    "Netherlands", "Burkina Faso", "Niger", "Kazakhstan", "Malawi",
                                                    "Cambodia", "Guatemala", "Ecuador", "Mali", "Zambia",
                                                    "Senegal", "Zimbabwe", "Chad", "Cuba", "Greece",
                                                    "Portugal", "Belgium", "Czech Republic", "Tunisia", "Guinea",
                                                    "Rwanda", "Dominican Republic", "Haiti", "Bolivia", "Hungary",
                                                    "Belarus", "Somalia", "Sweden", "Benin", "Azerbaijan",
                                                    "Burundi", "Austria", "Honduras", "Switzerland", "Bulgaria",
                                                    "Serbia", "Israel", "Tajikistan", "Hong Kong", "Papua New Guinea",
                                                    "Togo", "Libya", "Jordan", "Paraguay", "Laos",
                                                    "El Salvador", "Sierra Leone", "Nicaragua", "Kyrgyzstan", "Denmark",
                                                    "Slovakia", "Finland", "Eritrea", "Turkmenistan"
                                                ], {
                                                    preserveOrder: true // Otherwise the selected value is brought to the top
                                                });
                                                break;
                                        }
                                    },
                                    facetMatches : function(callback) {
                                        callback([
                                            'account', 
                                            'filter', 
                                            'access', 
                                            'title',
                                            { label: 'city',        category: 'location' },
                                            { label: 'address',     category: 'location' },
                                            { label: 'country',     category: 'location' },
                                            { label: 'U.S. State',  category: 'location' },
                                        ]);
                                    }
                                }
                            });
                        });
                    </script>
                </div>
            </div>
            <div th:include="include :: footer"></div>
        </div>	
    </body>
</html>